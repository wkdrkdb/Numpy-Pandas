"""
로우 삭제
    df.drop(로우 인덱스, axis = 0)
        원본은 그래도 유지되고 row가 삭제된 데이터프레임 객체가 리턴됨
"""

import pyupbit
import pandas as pd

df = pyupbit.get_ohlcv("KRW-BTC")
print(df)

df.drop(["volume", "value"], axis = 1, inplace = True)
print(df)

date = "2025-07-21 09:00:00"
dt = pd.to_datetime(date)
print(dt) # 2025-07-21 09:00:00

df.loc[dt] = [100, 110, 100, 100]
print(df.tail())
"""
                            open         high          low        close
2025-07-17 09:00:00  161246000.0  163955000.0  160002000.0  162232000.0
2025-07-18 09:00:00  162232000.0  164446000.0  159301000.0  161100000.0
2025-07-19 09:00:00  161098000.0  162470000.0  160788000.0  161428000.0
2025-07-20 09:00:00  161428000.0  162000000.0  159726000.0  160072000.0
2025-07-21 09:00:00        100.0        110.0        100.0        100.0
"""

print(df.index[-1]) # 2025-07-21 09:00:00

df.drop(df.index[-1], axis = 0, inplace = True)
print(df.tail())
"""
                            open         high          low        close
2025-07-16 09:00:00  160811000.0  163210000.0  160175000.0  161250000.0
2025-07-17 09:00:00  161246000.0  163955000.0  160002000.0  162232000.0
2025-07-18 09:00:00  162232000.0  164446000.0  159301000.0  161100000.0
2025-07-19 09:00:00  161098000.0  162470000.0  160788000.0  161428000.0
2025-07-20 09:00:00  161428000.0  162000000.0  159726000.0  160072000.0
"""